<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Plataforma ODS4 - Feedback</title>
  <link rel="stylesheet" href="css-aluno/styles-feedback.css">
</head>
<body>
  <header>
    <div class="container">
      <h1>Plataforma ODS4 - Educa√ß√£o Personalizada</h1>
      <h2>Feedback da Prova</h2>
    </div>
  </header>

  <main class="container">
    <section class="tempo-total">
      <p>
        <strong>‚è±Ô∏è Tempo total da prova:</strong>
        <span id="tempo-total">00:00:00</span>
      </p>
    </section>

    <section class="feedback-controls" aria-labelledby="filtro-label">
      <h3 id="filtro-label" class="visually-hidden">Filtros de Classifica√ß√£o</h3>
      <label for="filtro-classificacao">Mostrar classifica√ß√£o:</label>
      <select id="filtro-classificacao">
        <option value="geral">Geral</option>
        <option value="especifica">Espec√≠fica</option>
        <option value="ambas" selected>Ambas</option>
      </select>
    </section>

    <section class="feedback-questoes" aria-labelledby="feedback-questoes-label">
      <h3 id="feedback-questoes-label" class="visually-hidden">Feedback das Quest√µes</h3>
      <div id="feedback-questoes"></div>
    </section>
  </main>

  <section class="resumo-box container" aria-labelledby="resumo-label">
    <h2 id="resumo-label">Meu desempenho na prova</h2>
    <div class="resumo-content">
      <div class="resumo-info">
        <div class="nota-final" id="nota-final">0.00</div>
        <p>Total de quest√µes: <strong id="total-questoes">15</strong></p>
        <p>Quest√µes que acertei: <strong class="acertos" id="acertos">0</strong></p>
        <p>Quest√µes que errei: <strong class="erros" id="erros">0</strong></p>
        <p>Quest√µes em branco: <strong class="branco" id="branco">0</strong></p>
        <p>Aproveitamento: <strong class="aproveitamento" id="aproveitamento">0%</strong></p>
      </div>
      <div class="grafico-container">
        <canvas id="grafico-desempenho" aria-label="Gr√°fico de desempenho"></canvas>
      </div>
    </div>
  </section>

  <section class="ia-box container" aria-labelledby="ia-label">
    <h2 id="ia-label">üîç An√°lise Inteligente do Desempenho</h2>
    <p>Com base nos seus resultados, nossa IA pode gerar um feedback personalizado para melhorar seus estudos.</p>
    <textarea id="dadosDesempenhoIA" rows="6" aria-label="Dados de desempenho para an√°lise"></textarea>
    <button onclick="enviarParaIA()">Enviar para IA</button>
    <div id="respostaIA">
      <strong>üì• Feedback IA:</strong>
      <p id="ia-output">Aguardando an√°lise...</p>
    </div>
  </section>

  <footer class="container">
    <button onclick="voltar()" class="btn-voltar">Voltar ao In√≠cio</button>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="dados/questoes.js"></script>
  <script src="main-aluno.js"></script>

  <script>
  window.onload = function () {
    const resumo = JSON.parse(localStorage.getItem("resumo_resultado"));
    const tempo = parseInt(localStorage.getItem("tempo_total_final"));
    const respostas = JSON.parse(localStorage.getItem("respostas_usuario"));
    
    document.getElementById("acertos").innerText = resumo.acertos;
    document.getElementById("erros").innerText = resumo.erros;
    document.getElementById("brancos").innerText = resumo.brancos;

    const tempoStr = new Date(tempo * 1000).toISOString().substr(11, 8);
    document.getElementById("tempo-total").innerText = tempoStr;

    const total = resumo.acertos + resumo.erros + resumo.brancos;
    const ctx = document.getElementById('grafico-desempenho').getContext('2d');

    new Chart(ctx, {
      type: 'pie',
      data: {
        labels: ['Acertos', 'Erros', 'Brancos'],
        datasets: [{
          label: 'Desempenho',
          data: [resumo.acertos, resumo.erros, resumo.brancos],
          backgroundColor: ['#4CAF50', '#F44336', '#FFC107']
        }]
      }
    });
  };
</script>

</body>
</html>